import{a as O}from"./chunk-YRMUDQGJ.js";import{b as A,c as F,f as H,h as $,i as z,j as J,k as G,m as K,n as Q}from"./chunk-GIK46JSG.js";import{a as S}from"./chunk-NQTFGFCY.js";import{A as o,Aa as U,B as p,E as u,G as d,I as t,J as a,K as b,L as x,M as R,O as M,P as y,Q as w,S as r,T as c,U as v,V as h,W as f,X as g,Z as k,aa as j,ba as T,f as E,i as _,ja as W,ka as N,l as q,la as B,na as V,o as C,oa as L,ya as P,z as D}from"./chunk-VI7SCK4B.js";import"./chunk-TMC7WMLO.js";var X={headers:new V({"Content-Type":"application/json"})},Y=(()=>{class i{static{this.reservation="reservation/"}constructor(n){this.http=n}makeReservation(n,l,e,m){return this.http.post(`${S.apiURL}${i.reservation}${n}`,{user_id:l,reservation_date:e,equipment_state:m}).pipe()}postReservationById(n){return this.http.post(`${S.apiURL}${i.reservation}${n}`,X).pipe(E())}putReservationById(n){return this.http.put(`${S.apiURL}${i.reservation}${n}`,X).pipe(E())}static{this.\u0275fac=function(l){return new(l||i)(q(L))}}static{this.\u0275prov=_({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function te(i,I){if(i&1&&(t(0,"p",30),r(1),a()),i&2){let n=y();o(),c(n.message)}}function ie(i,I){i&1&&(t(0,"div",19)(1,"small",31),r(2," The end date must be greater than or equal to the start date. "),a()())}function ne(i,I){if(i&1&&(x(0),t(1,"p")(2,"small",28),r(3),j(4,"date"),a()(),R()),i&2){let n=y();o(3),v("Prochaine disponibilit\xE9: ",T(4,1,n.equipment.return_date,"medium"),"")}}var fe=(()=>{class i{constructor(n,l,e,m,s){this.route=n,this.reservationService=l,this.router=e,this.cookieService=m,this.equipmentService=s,this.equipmentId=null,this.userId="",this.reservationStartDate="",this.reservationEndDate="",this.equipmentState="",this.message="",this.dateValidationError=!1,this.today=new Date().toISOString().split("T")[0],this.equipment={equipment_id:0,name:"",description:"",category:"",availability:!0,status:"",reserfation_date:"",return_date:"",state:""}}ngOnInit(){this.equipmentId=this.route.snapshot.paramMap.get("id"),this.equipmentId!==null&&this.equipmentService.getById(this.equipmentId).subscribe(n=>{this.equipment=n}),console.log(this.equipmentId),this.userId=this.cookieService.get("user_id"),(!this.userId||this.userId==="")&&this.router.navigate(["/admin/login"])}makeReservation(){if(!this.equipmentId||!this.equipmentState||!this.reservationStartDate||!this.reservationEndDate){this.message="Please complete the form with the necessary details.";return}if(new Date(this.reservationStartDate)>new Date(this.reservationEndDate)){this.dateValidationError=!0,this.message="";return}else this.dateValidationError=!1;this.reservationService.makeReservation(this.equipmentId,this.userId,this.reservationStartDate,this.equipmentState).subscribe(n=>{this.message="Reservation successful!",this.router.navigate(["/reservations-done"])},n=>{this.message="Error making reservation",console.error(n)})}static{this.\u0275fac=function(l){return new(l||i)(p(P),p(Y),p(U),p(Q),p(O))}}static{this.\u0275cmp=C({type:i,selectors:[["app-reservation"]],standalone:!0,features:[k],decls:48,vars:15,consts:[[1,"container","mt-5","vh-100"],[1,"card"],[1,"card-header","green","text-white"],[1,"card-body"],["class","alert alert-info",4,"ngIf"],[1,"form-group"],["for","state",1,"mt-2","mb-2"],["id","state",1,"form-control",3,"ngModelChange","ngModel"],["value","","disabled","","selected",""],["value","Neuf"],["value","Us\xE9e"],["value","Cass\xE9e"],[1,"row"],[1,"col-md-6","col-12","mb-2","mt-2"],["for","inputStartDate",1,"form-label"],["type","date","id","inputStartDate","name","startDate","required","",1,"form-control",3,"ngModelChange","ngModel","min"],["for","inputEndDate",1,"form-label"],["type","date","id","inputEndDate","name","endDate","required","",1,"form-control",3,"ngModelChange","ngModel","min"],["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"btn","green","btn-block","col-11","m-3",3,"click"],[1,"row","m-3"],[1,"col-12","d-flex","align-items-stretch"],[1,"card","mb-4",2,"width","100%"],[1,"card-img-top",2,"height","400px",3,"src","alt"],[1,"card-body","d-flex","flex-column"],[1,"card-title"],[1,"card-text"],[1,"text-muted"],[4,"ngIf"],[1,"alert","alert-info"],[1,"text-danger"]],template:function(l,e){l&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),r(4,"Reserve Equipment"),a()(),t(5,"div",3),u(6,te,2,1,"p",4),t(7,"div",5)(8,"label",6),r(9,"Equipment State at Reservation:"),a(),t(10,"select",7),g("ngModelChange",function(s){return f(e.equipmentState,s)||(e.equipmentState=s),s}),t(11,"option",8),r(12,"Select state"),a(),t(13,"option",9),r(14,"Neuf"),a(),t(15,"option",10),r(16,"Us\xE9e"),a(),t(17,"option",11),r(18,"Cass\xE9e"),a()()(),t(19,"div",12)(20,"div",13)(21,"label",14),r(22,"Start Date"),a(),t(23,"input",15),g("ngModelChange",function(s){return f(e.reservationStartDate,s)||(e.reservationStartDate=s),s}),a()(),t(24,"div",13)(25,"label",16),r(26,"End Date"),a(),t(27,"input",17),g("ngModelChange",function(s){return f(e.reservationEndDate,s)||(e.reservationEndDate=s),s}),a()()(),u(28,ie,3,0,"div",18),t(29,"div",19)(30,"button",20),M("click",function(){return e.makeReservation()}),r(31,"Je Reserve"),a()()()(),t(32,"div",21)(33,"div",22)(34,"div",23),b(35,"img",24),t(36,"div",25)(37,"h5",26),r(38),a(),t(39,"p",27),r(40),a(),t(41,"p",27)(42,"small",28),r(43),a()(),t(44,"p",27)(45,"small",28),r(46),a()(),u(47,ne,5,4,"ng-container",29),a()()()()()),l&2&&(o(6),d("ngIf",e.message),o(4),h("ngModel",e.equipmentState),o(13),h("ngModel",e.reservationStartDate),d("min",e.today),o(4),h("ngModel",e.reservationEndDate),d("min",e.reservationStartDate),o(),d("ngIf",e.dateValidationError),o(7),w("alt","",e.equipment.name," image"),d("src","/assets/image/categorie/"+e.equipment.name+".webp",D),o(3),c(e.equipment.name),o(2),c(e.equipment.description),o(3),v("Etat: ",e.equipment.state,""),o(3),v("Availability: ",e.equipment.status==="reserved"?"reserved":"disponible",""),o(),d("ngIf",e.equipment.status==="reserved"))},dependencies:[W,K,z,J,A,$,F,G,H,B,N]})}}return i})();export{fe as default};
